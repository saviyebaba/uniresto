
{% extends "base.html" %}
{% block content %}
<div class="space-y-10 animate-entrance">
    <!-- Header Section -->
    <div class="flex flex-col md:flex-row justify-between items-end gap-4">
        <div class="max-w-xl">
            <h2 class="text-5xl font-black text-slate-900 tracking-tighter leading-none">Mes Billets<span class="text-indigo-600">.</span></h2>
            <p class="text-slate-500 font-bold mt-3 text-lg">Scannez votre ticket au guichet.</p>
        </div>
        <div class="bg-slate-100 p-1 rounded-xl flex space-x-1 shadow-inner border border-slate-200">
            <a href="{{ url_for('dashboard') }}" class="px-6 py-2.5 text-slate-500 hover:text-slate-900 rounded-lg font-bold text-xs transition-all">Le Menu</a>
            <a href="{{ url_for('my_tickets') }}" class="px-6 py-2.5 bg-white text-indigo-600 rounded-lg font-black text-xs shadow-sm transition-all">Mes Tickets</a>
        </div>
    </div>

    <!-- Tickets Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {% for booking in bookings %}
        
        {# TICKET MINIMALISTE #}
        <div class="uniresto-card group !rounded-3xl border-none shadow-lg overflow-hidden transition-all hover:-translate-y-1.5 {% if booking.ticket and booking.ticket.is_used %}opacity-40 grayscale-sm pointer-events-none{% endif %}">
            
            <!-- Ticket Header -->
            <div class="p-5 bg-white ticket-dashed">
                <div class="flex items-center justify-between mb-6">
                    <span class="badge {% if booking.is_paid %}badge-success{% else %}badge-warning{% endif %} !py-1 !px-3">
                        {{ 'PAYÉ' if booking.is_paid else 'À RÉGLER' }}
                    </span>
                    <span class="text-[8px] font-black text-slate-300 uppercase tracking-widest font-mono">#{{ booking.ticket.code }}</span>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center shadow-inner">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </div>
                    <div>
                        <h5 class="font-black text-slate-900 text-sm tracking-tight leading-none">{{ booking.menu.type_repas }}</h5>
                        <p class="text-[9px] text-indigo-500 font-black mt-1 uppercase tracking-wider">{{ booking.menu.date_menu|format_date }}</p>
                    </div>
                </div>
            </div>
            
            <!-- Ticket Body with QR Code -->
            <div class="p-6 bg-slate-50/20 flex flex-col items-center">
                <div class="qr-container mb-4">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data={{ booking.ticket.code }}&bgcolor=ffffff&color=4f46e5" 
                         alt="QR Code" 
                         class="w-20 h-20 md:w-24 md:h-24">
                </div>
                
                <div class="text-center">
                    <p class="text-[8px] font-black text-slate-300 uppercase tracking-widest mb-0.5">Vérification</p>
                    <p class="text-lg font-mono font-black text-slate-800 tracking-widest uppercase">{{ booking.ticket.code }}</p>
                </div>
                
                {% if booking.ticket and booking.ticket.is_used %}
                <div class="mt-4 py-2 w-full bg-slate-200 text-slate-500 rounded-lg text-[9px] font-black uppercase tracking-widest border border-slate-300 text-center">Utilisé</div>
                {% endif %}
            </div>
        </div>
        {% endfor %}

        {% if not bookings %}
        <div class="col-span-full py-24 text-center bg-white rounded-3xl border-2 border-dashed border-slate-200 shadow-sm">
            <h3 class="text-2xl font-black text-slate-200 uppercase tracking-tighter">Aucun billet</h3>
            <a href="{{ url_for('dashboard') }}" class="inline-block mt-8 btn-primary !px-10 !py-4 rounded-xl font-black shadow-lg">Réserver</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
